<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/magnific-popup.js/1.1.0/magnific-popup.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.0/css/font-awesome.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.css" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Luckiest+Guy" type="text/css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Karla:400,700" type="text/css">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jscolor/2.5.1/jscolor.min.js" integrity="sha512-/e+XGe8oSD9M1t0NKNCrUlRsiyeFTiZw4+pmf0g8wTbc8IfiLwJsjTODc/pq3hKhKAdsehJs7STPvX7SkFSpOQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

        <title>Moshi Online | Colourama</title>
    <style>
        #monster {
            margin:0 auto;
            display: none;
        }

        .esearch-loader {
            display: none;
            font-size: 25px;
            position: absolute;
            margin-left: -25px;
        }

        .coloramaOptions {
            display: none;
        }

        .logo {
            width: 50px;
        }
h1 {
    font-weight: bold;
    font-family: "Luckiest Guy", Arial, sans-serif;
    color: white;
}

h2 {
    color: #000000;
    font-family: "Luckiest Guy", Arial, sans-serif;

}

p {
    font-family: "Karla", sans-serif;

}
    </style>
</head>

<body>

    <section class="colorama" data-aos="fade-left">
        <div class="container py-5">
            <h2><a href="https://moshionline.net"><img src="./logo.png" class="logo"></a></h2>
            <p class="text-secondary">With this application, you can play around with different monsters and color combinations!</p>
            <hr>

            <div: id="monster" class="align-items-center justify-content-center"></div:>


            <div class="row mb-2">
                <div class="col-lg-6">
                    <label for="monster">Monster</label>
                    <select name="monster" id="monsterselect" class="form-control">
                        <option value="" disabled selected>Select a monster</option>
                        <option value="furi">Furi</option>
                        <option value="luvli">Luvli</option>
                        <option value="zommer">Zommer</option>
                        <option value="katsuma">Katsuma</option>
                        <option value="diavlo">Diavlo</option>
                        <option value="poppet">Poppet</option>
                    </select>
                </div>
                <div class="col-lg-6">
                <form class="form-horizontal" method="" id="eSearchForm">
                <p class="esearch-loader"><span class="spinner-border spinner-border-sm"></span></p>
                    <label for="player">Get Player's Monster</label>
                    <input class="form-control" type="text" id="player" placeholder="Enter a username"/>
                </div></form>

            </div>

            <div class="coloramaOptions">
            <br>
            <hr>
            <br>
            <div class="row mb-2">
                <div class="col-lg-6">
                    <label for="primary">Select primary Color</label>
                    <select name="primary" id="primary" class="form-control">
                        <option value="0" selected>Color 1</option>
                        <option value="1">Color 2</option>
                        <option value="2">Color 3</option>
                        <option value="3">Color 4</option>
                        <option value="4">Color 5</option>
                        <option value="5">Color 6</option>
                        <option value="6">Color 7</option>
                        <option value="7">Color 8</option>
                    </select>
                </div>
                <div class="col-lg-6">
                    <label for="secondary">Select secondary Color</label>
                    <select name="secondary" id="secondary" class="form-control">
                    <option value="0" selected>Color 1</option>
                        <option value="1">Color 2</option>
                        <option value="2">Color 3</option>
                        <option value="3">Color 4</option>
                        <option value="4">Color 5</option>
                        <option value="5">Color 6</option>
                        <option value="6">Color 7</option>
                        <option value="7">Color 8</option>
                    </select>
                </div>

                <div class="col-lg-4">
                    <label for="color1" id="col1"></label>
                    <input data-jscolor="" id="color1" name="color1" class="form-control">
                </div>

                <div class="col-lg-4">
                    <label for="color2" id="col2" ></label>
                    <input data-jscolor="" id="color2" name="color2" class="form-control">
                </div>

                <div class="col-lg-4">
                    <label for="color3" id="col3"></label>
                    <input data-jscolor="" id="color3" name="color3" class="form-control"></input>
                </div>
            </div>
            <button class="btn btn-primary" id="washbtn">Wash</button>

        </div>
    </div>
    </section>

    <section id="intro" data-aos="fade-right">
        <div class="container py-3">
        <h2>Colourama preview Instructions</h2>


<ul class="list-group mt-4">
  <li class="list-group-item">To start using, choose a monster from the dropdown menu or enter a username that you want get colors from.</li>
  <li class="list-group-item">The primary and secondary colors determine what the monster looks like without custom colors. You can customize these colors by choosing from a selection of 8 different options for each color.</li>
  <li class="list-group-item">You can also customize up to three different parts of the monster. These parts are labeled, and you can select a color for each part by clicking on the corresponding input field.</li>
  <li class="list-group-item">To go back to the website, you can click on the 'M' logo on the top.</li>
</ul>
        </div>
    </section>

    <div class="footer justify-content-center text-center mb-5">
<p>Moshi Monsters is a trademark of the Mind Candy company. We are not affiliated with the Mind Candy Company.</p>
<small>MoshiOnline.net is a non-profit, completely free-to-play, with no subscriptions, donations, or any means of generating revenue.</small>
</div>

    <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>

    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
        integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous">
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/magnific-popup.js/1.1.0/jquery.magnific-popup.min.js"></script>

<script>
AOS.init();

window.RufflePlayer = window.RufflePlayer || {};
window.RufflePlayer.config = {
"autoplay": "on",
"menu": false,
"contextMenu": false,
"splashScreen": false,
"unmuteOverlay": "hidden",
"warnOnUnsupportedContent": false,
"width": 300

};

let monster = null;

$(document).ready(function () {
  $("input").val('');
  $('#color1').val("#FFFFFF");
  $("#color2").val("#FFFFFF");
  $('#color3').val("#FFFFFF");
  $("select").prop('selectedIndex', 0);
});

window.addEventListener("load", () => {
  const ruffle = window.RufflePlayer.newest();
  const player = ruffle.createPlayer();
  const container = document.getElementById("monster");
  container.appendChild(player);

  player.style.width = "300px";
  player.style.height = "400px";

  let colours = {
    primary: "000000",
    secondary: "000000"
  };

  $("#eSearchForm").on("submit", function (e) {
    e.preventDefault();
    const playerId = $("#player").val();
    $(".esearch-loader").show();

    $.ajax({
      url: "https://moshionline.net/api",
      data: { monsterColours: playerId },
      method: "GET",
      dataType: "json",
      success: function (response) {
        $(".esearch-loader").hide();
        console.log(response);

        if (!response.success) {
          Swal.fire({
            title: "Uh oh!",
            icon: "error",
            text: "Could not get this user :(",
            allowOutsideClick: false,
            allowEscapeKey: false
          });
          return;
        }

        monster = response.data.type;
        $("#monsterselect").val(monster);

        colours.primary = response.data.primarycolour;
        colours.secondary = response.data.secondarycolour;

        if (response.data.customcolour1 && response.data.customcolour2 && response.data.customcolour3) {
          colours.colour1 = response.data.customcolour1;
          colours.colour2 = response.data.customcolour2;
          colours.colour3 = response.data.customcolour3;

          $('#color1').val(`#${response.data.customcolour1}`);
          $('#color2').val(`#${response.data.customcolour2}`);
          $('#color3').val(`#${response.data.customcolour3}`);
        }

        $("#primary").val(response.data.primarycolour);
        $("#secondary").val(response.data.secondarycolour);

        updatePresets(monster);
        loadPlayer(player, monster, colours);
      }
    });
  });

  $("#monsterselect").on("change", function () {
    monster = $(this).val();
    loadPlayer(player, monster, colours);
    updatePresets(monster);
  });

  $("#primary").on("change", function () {
    colours.primary = $(this).val().replace('#', '');
    loadPlayer(player, monster, colours);
  });

  $("#secondary").on("change", function () {
    colours.secondary = $(this).val().replace('#', '');
    loadPlayer(player, monster, colours);
  });

  $("#color1").on("change", function () {
    if (!colours.colour2 && !colours.colour3) {
      colours.colour2 = "FFFFFF";
      colours.colour3 = "FFFFFF";
    }
    colours.colour1 = $(this).val().replace('#', '');
    loadPlayer(player, monster, colours);
  });

  $("#color2").on("change", function () {
    if (!colours.colour1 && !colours.colour3) {
      colours.colour1 = "FFFFFF";
      colours.colour3 = "FFFFFF";
    }
    colours.colour2 = $(this).val().replace('#', '');
    loadPlayer(player, monster, colours);
  });

  $("#color3").on("change", function () {
    if (!colours.colour1 && !colours.colour2) {
      colours.colour1 = "FFFFFF";
      colours.colour2 = "FFFFFF";
    }
    colours.colour3 = $(this).val().replace('#', '');
    loadPlayer(player, monster, colours);
  });

  $("#washbtn").on("click", function () {
    const resetColours = { primary: "000000", secondary: "000000" };
    loadPlayer(player, monster, resetColours);
  });
});

function loadPlayer(player, monster, colours) {
  player.load({
    url: `https://assets01.moshionline.net/static/assets-static.version/1.7/flash/monsters/${monster}/avatar_animated.swf`,
    parameters: colours,
    backgroundColor: "#FFFFFF"
  }).then(() => {
    $(".coloramaOptions").fadeIn();
    $("#monster").addClass("d-flex").show();
    $(".char-loader").removeClass("d-flex").hide();
  });
}

function updatePresets(monster) {
  switch (monster) {
    case "poppet":
      $("#col1").text("Body");
      $("#col2").text("Eyes");
      $("#col3").text("Feet");
      break;
    case "zommer":
      $("#col1").text("Body");
      $("#col2").text("Hair");
      $("#col3").text("Shirt");
      break;
    case "luvli":
      $("#col1").text("Body");
      $("#col2").text("Tail");
      $("#col3").text("Eyes");
      break;
    case "katsuma":
      $("#col1").text("Body");
      $("#col2").text("Stripes");
      $("#col3").text("Eyes");
      break;
    case "diavlo":
      $("#col1").text("Body");
      $("#col2").text("Face");
      $("#col3").text("Eyes");
      break;
    case "furi":
      $("#col1").text("Body");
      $("#col2").text("Eyes");
      $("#col3").text("Feet");
      break;
  }
}
</script>

<script src="https://unpkg.com/@ruffle-rs/ruffle"></script>
</body>
</html>
